!function(){var e=angular.module("nzDatepicker",[]);e.directive("nzDatepicker",["$compile","$timeout",function(e,t){var n="CUSTOM";return{restrict:"AE",replace:!1,template:['<span tabindex="0" ng-keydown="hide()" class="nz-datepicker-input">','     <span ng-if="showRanged">','          <span ng-show="!!model">{{model.start.format("ll")}}-{{model.end.format("ll")}}</span>','          <span ng-hide="!!model">Select date range</span>',"     </span>",'     <span ng-if="!showRanged">','          <span ng-show="!!model">{{model.format("ll")}}</span>','          <span ng-hide="!!model">Select date</span>',"     </span>","</span>",'<div ng-show="visible" class="nz-datepicker-picker" ng-click="handlePickerClick($event)" ng-class="{\'nz-datepicker-ranged\': showRanged }">','    <div class="nz-datepicker-timesheet">','        <a ng-click="move(-1, $event)" class="nz-datepicker-prev-month">&#9664;</a>','        <div ng-repeat="month in months" class="nz-datepicker-month">','            <div class="nz-datepicker-month-name">{{month.name}}</div>','            <table class="nz-datepicker-calendar">',"                <tr>",'                    <th ng-repeat="day in month.weeks[1]" class="nz-datepicker-calendar-weekday">{{day.date.format(\'dd\')}}</th>',"                </tr>",'                <tr ng-repeat="week in month.weeks">',"                    <td ng-class=\"{'nz-datepicker-calendar-day': day,'nz-datepicker-calendar-day-selected': day.selected,'nz-datepicker-calendar-day-disabled': day.disabled,'nz-datepicker-calendar-day-start': day.start}\" ng-repeat=\"day in week track by $index\" ng-click=\"select(day, $event)\">",'                        <div class="nz-datepicker-calendar-day-wrapper">{{day.date.date()}}</div>',"                    </td>","                </tr>","            </table>","        </div>",'        <a ng-click="move(+1, $event)" class="nz-datepicker-next-month">&#9654;</a>',"    </div>",'    <div class="nz-datepicker-panel">','       <div ng-show="showRanged">','           <select ng-click="prevent_select($event)" ng-model="quick">','              <option disabled="disabled" selected>Select Date Range</option>','              <option value="e.range" ng-repeat="e in quickList">{{e.label}}</option>',"           </select>","       </div>",'        <div class="nz-datepicker-buttons"><a ng-click="ok($event)" class="nz-datepicker-apply">Apply</a><a ng-click="hide($event)" class="nz-datepicker-cancel">cancel</a></div>',"    </div>","</div>"].join(""),scope:{model:"=ngModel",options:"=?",ranged:"=",pastDates:"@",callback:"&"},link:function(e,a){function o(){return[{label:"This week",range:moment().range(moment().startOf("week").startOf("day"),moment().endOf("week").startOf("day"))},{label:"Next week",range:moment().range(moment().startOf("week").add(1,"week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This fortnight",range:moment().range(moment().startOf("week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This month",range:moment().range(moment().startOf("month").startOf("day"),moment().endOf("month").startOf("day"))},{label:"Next month",range:moment().range(moment().startOf("month").add(1,"month").startOf("day"),moment().add(1,"month").endOf("month").startOf("day"))}]}function r(){return e.selection=e.model,g(),h(),e.visible=!0}function s(t){return null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),e.visible=!1,e.start=null}function i(e){return null!=e&&"function"==typeof e.stopPropagation?e.stopPropagation():void 0}function d(n){return null!=n&&"function"==typeof n.stopPropagation&&n.stopPropagation(),e.model=e.selection,t(function(){return e.callback?e.callback():void 0}),e.hide()}function l(t,n){return null!=n&&"function"==typeof n.stopPropagation&&n.stopPropagation(),t.disabled?void 0:(e.showRanged?(e.selecting=!e.selecting,e.selecting?e.start=t.date:(e.selection=moment().range(e.start,t.date),e.start=null)):e.selection=moment(t.date),h())}function c(t,n){return null!=n&&"function"==typeof n.stopPropagation&&n.stopPropagation(),e.showRanged?e.range=moment().range(e.range.start.add(t,"months").startOf("month").startOf("day"),e.range.start.clone().add(2,"months").endOf("month").startOf("day")):(e.date.add(t,"months"),e.range=moment().range(moment(e.date).startOf("month"),moment(e.date).endOf("month"))),h()}function m(e){return null!=e&&"function"==typeof e.stopPropagation?e.stopPropagation():void 0}function p(){return e.$apply(function(){return e.hide()}),!0}function u(t){var a,o,r,s,i;if(null==t&&(t=!1),e.showRanged){for(e.quickList=[],t&&e.quickList.push({label:"Custom",range:n}),s=e.options,i=[],o=0,r=s.length;r>o;o++)a=s[o],i.push(e.quickList.push(a));return i}}function g(){var t,n;return e.showRanged?e.range=e.selection?(n=e.selection.start.clone().startOf("month").startOf("day"),t=n.clone().add(2,"months").endOf("month").startOf("day"),moment().range(n,t)):moment().range(moment().startOf("month").subtract(1,"month").startOf("day"),moment().endOf("month").add(1,"month").startOf("day")):(e.selection=!1,e.selection=e.model||!1,e.date=moment(e.model)||moment(),e.range=moment().range(moment(e.date).startOf("month"),moment(e.date).endOf("month")))}function f(){var t,a,o,r;if(e.showRanged&&e.selection){for(r=e.quickList,a=0,o=r.length;o>a;a++)if(t=r[a],t.range!==n&&e.selection.start.startOf("day").unix()===t.range.start.startOf("day").unix()&&e.selection.end.startOf("day").unix()===t.range.end.startOf("day").unix())return e.quick=t.range,void u();return e.quick=n,u(!0)}}function h(){var t,n,a,o,r,s;for(e.months=[],s=12*e.range.start.year()+e.range.start.month(),r=moment().startOf("week").day(),e.range.by("days",function(t){var n,a,o,i,d,l,c;return o=t.day()-r,0>o&&(o=7+o),d=12*t.year()+t.month()-s,c=parseInt((7+t.date()-o)/7),l=!1,i=!1,e.showRanged?e.start?(l=t===e.start,i=t<e.start):l=e.selection&&e.selection.contains(t):(l=t.isSame(e.selection),e.pastDates&&(i=moment().diff(t,"days")>0)),(n=e.months)[d]||(n[d]={name:t.format("MMMM YYYY"),weeks:[]}),(a=e.months[d].weeks)[c]||(a[c]=[]),e.months[d].weeks[c][o]={date:t,selected:l,disabled:i,start:e.start&&e.start.unix()===t.unix()}}),o=e.months,t=0,n=o.length;n>t;t++)a=o[t],a.weeks[0]||a.weeks.splice(0,1);return f()}return e.quick=null,e.range=null,e.selecting=!1,e.visible=!1,e.start=null,e.showRanged=void 0===e.ranged?!0:e.ranged,e.options&&e.options.length||(e.options=o()),e.show=r,e.hide=s,e.prevent_select=i,e.ok=d,e.select=l,e.move=c,e.handlePickerClick=m,angular.element(document).bind("click",p),a.bind("click",function(t){return null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),e.$apply(function(){return e.visible?e.hide():e.show()})}),e.$watch("quick",function(t){return t&&t!==n?(e.selection=e.quick,e.selecting=!1,e.start=null,g(),h()):void 0}),e.$watch("options",function(t){return"undefined"!=typeof options&&null!==options?e.options=t:void 0}),e.$on("$destroy",function(){return angular.element(document).unbind("click",p)}),u(),g(),h()}}}])}();